!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("storage.js",[],t):"object"==typeof exports?exports["storage.js"]=t():e["storage.js"]=t()}(this,(()=>(()=>{"use strict";var e={774:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(837),i=r(62),a=function(){function e(e){this.config=n(n({},o.DefaultConfig),e);var t=(0,i.joinAndSplit)(this.config.separator),r=t.join,a=t.split;this.join=r,this.split=a}return Object.defineProperty(e.prototype,"root",{get:function(){var e=this.config.storage.getItem(this.config.name);return null===e?(this.config.storage.setItem(this.config.name,JSON.stringify({})),{}):JSON.parse(e)},set:function(e){this.config.storage.setItem(this.config.name,JSON.stringify(e))},enumerable:!1,configurable:!0}),e}();t.default=a},837:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultConfig=void 0,t.DefaultConfig={name:"",storage:window.localStorage,separator:"-",keyValueSeparator:":"}},543:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(363),u=a(r(4)),c=function(e){function t(t){var r=e.call(this,t)||this;return r.concatLayeredKeys=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.join.apply(r,i([e],t,!1))},r.getAndSet=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return[function(){return r.get.apply(r,i([e],t,!1))},function(n){return r.set.apply(r,i([n,e],t,!1))}]},r.registerEventListener=function(e,t,n){return r.addEventListener(e,t,n),function(){return r.removeEventListener(e,t)}},r.eventListener=new u.default(r.config.separator,r.config.keyValueSeparator),r}return o(t,e),t.prototype.get=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return(0,s.access)(this.root,this.config.separator,this.config.keyValueSeparator,i([e],t,!0))},t.prototype.set=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];this.root=(0,s.update)(e,this.root,this.config.separator,this.config.keyValueSeparator,i([t],r,!0)),this.eventListener.exec(this.join.apply(this,i([t],r,!1)),this.root)},t.prototype.remove=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.root=(0,s.remove)(this.root,this.config.separator,this.config.keyValueSeparator,i([e],t,!0)),this.eventListener.exec(this.join.apply(this,i([e],t,!1)),this.root)},t.prototype.push=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];this.root=(0,s.push)(e,this.root,this.config.separator,this.config.keyValueSeparator,i([t],r,!0)),this.eventListener.exec(this.join.apply(this,i([t],r,!1)),this.root)},t.prototype.clear=function(){this.config.storage.removeItem(this.config.name)},t.prototype.addEventListener=function(e,t,r){this.eventListener.add(e,t,r)},t.prototype.removeEventListener=function(e,t){this.eventListener.remove(e,t)},t}(a(r(774)).default);t.default=c},62:function(e,t,r){var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getRelation=t.Relation=t.hasKeyValue=t.KeyValue=t.isKeyValue=t.normalizeLayeredKeys=t.getLayerKeys=t.joinAndSplit=void 0;var o,i=r(518),a=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.join(e)}},s=function(e){return function(t){return t.split(e)}};t.joinAndSplit=function(e){return{join:a(e),split:s(e)}},t.getLayerKeys=function(e){return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=(0,t.joinAndSplit)(e),s=a.join;return(0,a.split)(s.apply(void 0,r)).reduce((function(e,t){return n(n([],e,!0),[s((0,i.lastOne)(e),t)],!1)}),[])}},t.normalizeLayeredKeys=function(e){return function(r){var n=(0,t.joinAndSplit)(e),o=n.join;return(0,n.split)(o.apply(void 0,r))}},t.isKeyValue=function(e,t){return 2===e.split(t).length},t.KeyValue=function(e,t){var r=e.split(t);return{key:r[0],value:r[1]}},t.hasKeyValue=function(e,t){return("string"==typeof e[t.key]?e[t.key]:JSON.stringify(e[t.key]))===t.value},function(e){e.none="none",e.ancestor="ancestor",e.itself="itself",e.descendants="descendants"}(o||(t.Relation=o={})),t.getRelation=function(e,t){for(var r=0;r<e.length;r++){if(void 0===t[r])return o.ancestor;if(e[r]!=e[r])return o.none}return e.length===t.length?o.itself:o.descendants}},363:function(e,t,r){var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.push=t.remove=t.update=t.access=void 0;var o=r(62),i=r(518),a=function(e,t,r){if(void 0===e)return[];if(0===r.length)return[e];var i=(r=n([],r,!0)).shift();if(Array.isArray(e)&&(0,o.isKeyValue)(i,t)){var s=(0,o.KeyValue)(i,t);return e.filter((function(e){return(0,o.hasKeyValue)(e,s)})).map((function(e){return a(e,t,r)})).reduce((function(e,t){return n(n([],e,!0),t,!0)}),[])}return a(e[i],t,r)};t.access=function(e,t,r,n){return 0===n.length?[e]:(n=(0,o.normalizeLayeredKeys)(t)(n),a(e,r,n))},t.update=function(e,r,n,a,s,u){r=(0,i.copy)(r);var c=(s=(0,o.normalizeLayeredKeys)(n)(s)).pop();return(0,t.access)(r,n,a,s).forEach((function(t,r){if(void 0===u||r===u)if(Array.isArray(t)&&(0,o.isKeyValue)(c,a)){var n=(0,o.KeyValue)(c,a);t.map((function(e){return(0,o.hasKeyValue)(e,n)})).forEach((function(r,n){r&&(t[n]=e)}))}else t[c]=e})),r},t.remove=function(e,r,n,a){e=(0,i.copy)(e);var s=(a=(0,o.normalizeLayeredKeys)(r)(a)).pop();return(0,t.access)(e,r,n,a).forEach((function(e){if(Array.isArray(e)&&(0,o.isKeyValue)(s,n)){var t=(0,o.KeyValue)(s,n);e.map((function(e){return(0,o.hasKeyValue)(e,t)})).forEach((function(t,r){t&&delete e[r]}))}else delete e[s]})),(0,t.access)(e,r,n,a).forEach((function(o,i){Array.isArray(o)&&(e=(0,t.update)(o.filter((function(e){return e})),e,r,n,a,i))})),e},t.push=function(e,r,a,s,u){return r=(0,i.copy)(r),u=(0,o.normalizeLayeredKeys)(a)(u),(0,t.access)(r,a,s,u).forEach((function(o,i){Array.isArray(o)&&(r=(0,t.update)(n(n([],o,!0),[e],!1),r,a,s,u,i))})),r}},4:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=r(62),a=r(363),s={parent:!1,children:!1};t.default=function(e,t){var r=this;this.handlerWrappers=[],this.add=function(e,t,i){r.handlerWrappers=o(o([],r.handlerWrappers,!0),[{key:e,handler:t,isAffectedBy:n(n({},s),i)}],!1),r.handlerWrappers.sort((function(e,t){return e.key>t.key?1:e.key<t.key?-1:0}))},this.remove=function(e,t){var n={key:e,handler:t},o=Object.entries(n).filter((function(e){return e[1]})).map((function(e){return e[0]}));r.handlerWrappers=r.handlerWrappers.filter((function(e){return o.reduce((function(t,r){return t||e[r]!==n[r]}),!1)}))},this.exec=function(e,t){var n=(0,i.normalizeLayeredKeys)(r.separator)([e]);r.handlerWrappers.forEach((function(e){var o=r.split(e.key),s=(0,i.getRelation)(n,o);(s===i.Relation.itself||s===i.Relation.ancestor&&e.isAffectedBy.children||s===i.Relation.descendants&&e.isAffectedBy.parent)&&(0,a.access)(t,r.separator,r.keyValueSeparator,o).forEach((function(t){return e.handler(t)}))}))},this.separator=e,this.keyValueSeparator=t;var u=(0,i.joinAndSplit)(e).split;this.split=u}},518:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.copy=t.lastOne=void 0,t.lastOne=function(e){return e[e.length-1]},t.copy=function(e){return JSON.parse(JSON.stringify(e))}}},t={};return function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(543)})()));