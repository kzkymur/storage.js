!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("storage.js",[],e):"object"==typeof exports?exports["storage.js"]=e():t["storage.js"]=e()}(this,(()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>E});var r,n=function(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.join(t)}},o=function(t){return function(e){return e.split(t)}},i=function(t){return{join:n(t),split:o(t)}},a=function(t){return function(e){var r=i(t),n=r.join;return(0,r.split)(n.apply(void 0,e))}},s=function(t,e){return 2===t.split(e).length},c=function(t,e){var r=t.split(e);return{key:r[0],value:r[1]}},f=function(t,e){return("string"==typeof t[e.key]?t[e.key]:JSON.stringify(t[e.key]))===e.value};!function(t){t.none="none",t.ancestor="ancestor",t.itself="itself",t.descendants="descendants"}(r||(r={}));var u=function(t){return JSON.parse(JSON.stringify(t))},p=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},l=function(t,e,r){if(void 0===t)return[];if(0===r.length)return[t];var n=(r=p([],r,!0)).shift();if(Array.isArray(t)&&s(n,e)){var o=c(n,e);return t.filter((function(t){return f(t,o)})).map((function(t){return l(t,e,r)})).reduce((function(t,e){return p(p([],t,!0),e,!0)}),[])}return l(t[n],e,r)},h=function(t,e,r,n){return 0===n.length?[t]:(n=a(e)(n),l(t,r,n))},y=function(t,e,r,n,o,i){e=u(e);var p=(o=a(r)(o)).pop();return h(e,r,n,o).forEach((function(e,r){if(void 0===i||r===i)if(Array.isArray(e)&&s(p,n)){var o=c(p,n);e.map((function(t){return f(t,o)})).forEach((function(r,n){r&&(e[n]=t)}))}else e[p]=t})),e},g=function(){return g=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},g.apply(this,arguments)},v=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},d={parent:!1,children:!1};const j=function(t,e){var n=this;this.handlerWrappers=[],this.add=function(t,e,r){n.handlerWrappers=v(v([],n.handlerWrappers,!0),[{key:t,handler:e,isAffectedBy:g(g({},d),r)}],!1),n.handlerWrappers.sort((function(t,e){return t.key>e.key?1:t.key<e.key?-1:0}))},this.remove=function(t,e){var r={key:t,handler:e},o=Object.entries(r).filter((function(t){return t[1]})).map((function(t){return t[0]}));n.handlerWrappers=n.handlerWrappers.filter((function(t){return o.reduce((function(e,n){return e||t[n]!==r[n]}),!1)}))},this.exec=function(t,e){var o=a(n.separator)([t]);n.handlerWrappers.forEach((function(t){var i=n.split(t.key),a=function(t,e){for(var n=0;n<t.length;n++){if(void 0===e[n])return r.ancestor;if(t[n]!=t[n])return r.none}return t.length===e.length?r.itself:r.descendants}(o,i);(a===r.itself||a===r.ancestor&&t.isAffectedBy.children||a===r.descendants&&t.isAffectedBy.parent)&&h(e,n.separator,n.keyValueSeparator,i).forEach((function(e){return t.handler(e)}))}))},this.separator=t,this.keyValueSeparator=e;var o=i(t).split;this.split=o};var m,O={storage:window.localStorage,separator:"-",keyValueSeparator:":",name:""},b=function(){return b=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},b.apply(this,arguments)},S=function(){function t(t){this.config=b(b({},O),t);var e=i(this.config.separator),r=e.join,n=e.split;this.join=r,this.split=n}return Object.defineProperty(t.prototype,"root",{get:function(){var t=this.config.storage.getItem(this.config.name);return null===t?(this.config.storage.setItem(this.config.name,JSON.stringify({})),{}):JSON.parse(t)},set:function(t){this.config.storage.setItem(this.config.name,JSON.stringify(t))},enumerable:!1,configurable:!0}),t}(),A=(m=function(t,e){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},m(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),k=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};const E=function(t){function e(e){var r=t.call(this,e)||this;return r.concatLayeredKeys=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return r.join.apply(r,k([t],e,!1))},r.getAndSet=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return[function(){return r.get.apply(r,k([t],e,!1))},function(n){return r.set.apply(r,k([n,t],e,!1))}]},r.registerEventListener=function(t,e,n){return r.addEventListener(t,e,n),function(){return r.removeEventListener(t,e)}},r.eventListener=new j(r.config.separator,r.config.keyValueSeparator),r}return A(e,t),e.prototype.get=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return h(this.root,this.config.separator,this.config.keyValueSeparator,k([t],e,!0))},e.prototype.set=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];this.root=y(t,this.root,this.config.separator,this.config.keyValueSeparator,k([e],r,!0)),this.eventListener.exec(this.join.apply(this,k([e],r,!1)),this.root)},e.prototype.remove=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.root=function(t,e,r,n){t=u(t);var o=(n=a(e)(n)).pop();return h(t,e,r,n).forEach((function(t){if(Array.isArray(t)&&s(o,r)){var e=c(o,r);t.map((function(t){return f(t,e)})).forEach((function(e,r){e&&delete t[r]}))}else delete t[o]})),h(t,e,r,n).forEach((function(o,i){Array.isArray(o)&&(t=y(o.filter((function(t){return t})),t,e,r,n,i))})),t}(this.root,this.config.separator,this.config.keyValueSeparator,k([t],e,!0)),this.eventListener.exec(this.join.apply(this,k([t],e,!1)),this.root)},e.prototype.push=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];this.root=function(t,e,r,n,o){return e=u(e),o=a(r)(o),h(e,r,n,o).forEach((function(i,a){Array.isArray(i)&&(e=y(p(p([],i,!0),[t],!1),e,r,n,o,a))})),e}(t,this.root,this.config.separator,this.config.keyValueSeparator,k([e],r,!0)),this.eventListener.exec(this.join.apply(this,k([e],r,!1)),this.root)},e.prototype.clear=function(){this.config.storage.removeItem(this.config.name)},e.prototype.addEventListener=function(t,e,r){this.eventListener.add(t,e,r)},e.prototype.removeEventListener=function(t,e){this.eventListener.remove(t,e)},e}(S);return e})()));