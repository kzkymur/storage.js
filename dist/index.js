!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("storage.js",[],r):"object"==typeof exports?exports["storage.js"]=r():t["storage.js"]=r()}(this,(()=>(()=>{"use strict";var t={d:(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{default:()=>A});var e,n=function(t){return function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return r.join(t)}},o=function(t){return function(r){return r.split(t)}},i=function(t){return{join:n(t),split:o(t)}},a=function(t){return function(r){var e=i(t),n=e.join;return(0,e.split)(n.apply(void 0,r))}},s=function(t,r){return 2===t.split(r).length},c=function(t,r){var e=t.split(r);return{key:e[0],value:e[1]}},f=function(t,r){return("string"==typeof t[r.key]?t[r.key]:JSON.stringify(t[r.key]))===r.value};!function(t){t.none="none",t.ancestor="ancestor",t.itself="itself",t.descendants="descendants"}(e||(e={}));var u=function(t){return JSON.parse(JSON.stringify(t))},p=function(t,r,e){if(e||2===arguments.length)for(var n,o=0,i=r.length;o<i;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return t.concat(n||Array.prototype.slice.call(r))},l=function(t,r,e){if(void 0===t)return[];if(0===e.length)return[t];var n=(e=p([],e,!0)).shift();if(Array.isArray(t)&&s(n,r)){var o=c(n,r);return t.filter((function(t){return f(t,o)})).map((function(t){return l(t,r,e)})).reduce((function(t,r){return p(p([],t,!0),r,!0)}),[])}return l(t[n],r,e)},h=function(t,r,e,n){return 0===n.length?[t]:(n=a(r)(n),l(t,e,n))},y=function(t,r,e,n,o,i){r=u(r);var p=(o=a(e)(o)).pop();return h(r,e,n,o).forEach((function(r,e){if(void 0===i||e===i)if(Array.isArray(r)&&s(p,n)){var o=c(p,n);r.map((function(t){return f(t,o)})).forEach((function(e,n){e&&(r[n]=t)}))}else r[p]=t})),r},g=function(){return g=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},g.apply(this,arguments)},d=function(t,r,e){if(e||2===arguments.length)for(var n,o=0,i=r.length;o<i;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return t.concat(n||Array.prototype.slice.call(r))},v={parent:!1,children:!1};const j=function(t,r){var n=this;this.handlerWrappers=[],this.add=function(t,r,e){n.handlerWrappers=d(d([],n.handlerWrappers,!0),[{key:t,handler:r,isAffectedBy:g(g({},v),e)}],!1),n.handlerWrappers.sort((function(t,r){return t.key>r.key?1:t.key<r.key?-1:0}))},this.remove=function(t){n.handlerWrappers=n.handlerWrappers.filter((function(r){return r.handler!==t}))},this.exec=function(t,r){var o=a(n.separator)([t]);n.handlerWrappers.forEach((function(t){var i=n.split(t.key),a=function(t,r){for(var n=0;n<t.length;n++){if(void 0===r[n])return e.ancestor;if(t[n]!=t[n])return e.none}return t.length===r.length?e.itself:e.descendants}(o,i);(a===e.itself||a===e.ancestor&&t.isAffectedBy.children||a===e.descendants&&t.isAffectedBy.parent)&&h(r,n.separator,n.keyValueSeparator,i).forEach((function(r){return t.handler(r)}))}))},this.separator=t,this.keyValueSeparator=r;var o=i(t).split;this.split=o};var m,O={storage:window.localStorage,separator:"-",keyValueSeparator:":",name:""},b=function(){return b=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},b.apply(this,arguments)},S=function(){function t(t){this.config=b(b({},O),t);var r=i(this.config.separator),e=r.join,n=r.split;this.join=e,this.split=n}return Object.defineProperty(t.prototype,"root",{get:function(){var t=this.config.storage.getItem(this.config.name);return null===t?(this.config.storage.setItem(this.config.name,JSON.stringify({})),{}):JSON.parse(t)},set:function(t){this.config.storage.setItem(this.config.name,JSON.stringify(t))},enumerable:!1,configurable:!0}),t}(),k=(m=function(t,r){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},m(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=t}m(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)});const A=function(t){function r(r){var e=t.call(this,r)||this;return e.eventListener=new j(e.config.separator,e.config.keyValueSeparator),e}return k(r,t),r.prototype.get=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return h(this.root,this.config.separator,this.config.keyValueSeparator,t)},r.prototype.set=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.root=y(t,this.root,this.config.separator,this.config.keyValueSeparator,r),this.eventListener.exec(this.join.apply(this,r),this.root)},r.prototype.remove=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.root=function(t,r,e,n){t=u(t);var o=(n=a(r)(n)).pop();return h(t,r,e,n).forEach((function(t){if(Array.isArray(t)&&s(o,e)){var r=c(o,e);t.map((function(t){return f(t,r)})).forEach((function(r,e){r&&delete t[e]}))}else delete t[o]})),h(t,r,e,n).forEach((function(o,i){Array.isArray(o)&&(t=y(o.filter((function(t){return t})),t,r,e,n,i))})),t}(this.root,this.config.separator,this.config.keyValueSeparator,t),this.eventListener.exec(this.join.apply(this,t),this.root)},r.prototype.push=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.root=function(t,r,e,n,o){return r=u(r),o=a(e)(o),h(r,e,n,o).forEach((function(i,a){Array.isArray(i)&&(r=y(p(p([],i,!0),[t],!1),r,e,n,o,a))})),r}(t,this.root,this.config.separator,this.config.keyValueSeparator,r),this.eventListener.exec(this.join.apply(this,r),this.root)},r.prototype.clear=function(){this.config.storage.removeItem(this.config.name)},r.prototype.addEventListener=function(t,r,e){this.eventListener.add(t,r,e)},r.prototype.removeEventListener=function(t){this.eventListener.remove(t)},r}(S);return r})()));